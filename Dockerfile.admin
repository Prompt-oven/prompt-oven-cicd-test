# Base image with Node.js 22 for running the production app
FROM node:20

WORKDIR /admin-app

# Copy the build artifacts from GitHub Actions (already downloaded to the workspace)
COPY ./apps/admin/.next /admin-app/.next

# Copy package.json and pnpm-lock.yaml files
COPY ./apps/admin/package.json pnpm-lock.yaml /admin-app/

# Install runtime dependencies
RUN npm install -g pnpm@9.12.2
RUN pnpm install

# Expose the necessary port
EXPOSE 3000

# Start the application
CMD ["pnpm", "start"]